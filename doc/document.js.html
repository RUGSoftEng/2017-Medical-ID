<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: document.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: document.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>define(['medid/creator', 'medid/util', 'medid/res', 'pdfmake', 'vfs_fonts'], function(Creator, Util) {

	/**
	 * The document module implements document creation functionality upon the creator.js module.
	 * Its main functionality lies in the createPDF method, which generates the Medical ID document PDF.
	 *
	 * @exports MIDdocument
	 * @requires creator
	 * @requires util
	 * @requires pdfMake
	 */
	var MIDdocument = {};

	/**
	 * This style object contains some settings regarding the style of the document.
	 * @member {Object}
	 */
	MIDdocument.documentStyle = {
		header: {
			fontSize: 22,
			bold: true
		},
		subheader: {
			fontSize: 17,
			margin: [20, 0]
		},
		smallSubheader: {
			fontSize: 10,
			margin: [20, 0]
		},
		fields: {
			alignment: 'justify'
		}
	};

	/**
	 * The width of the label used in the document.
	 * @member {number}
	 */
	MIDdocument.labelWidth = 160;
	/**
	 * The width and height of the logo in the top right corner of the document.
	 * @member {number}
	 */
	MIDdocument.logoSize = 100;

	/**
	 * Method to generate the Medical ID document PDF.
	 * Uses the fields() method of the creator module as input data.
	 * @returns {Object} The object of the generated document.
	 */
	MIDdocument.createPDF = function () {
		// Get fields from Creator engine, turn them into something useful
		var fields = MIDdocument.parseFields( Creator.fields() );

		/* This is the actual final document definition
		 * This object alone defines the creation of the PDF
		 */
		var doc = {
			content: [
				{
					columns: [
						[
							{ text: 'Medical ID', style: 'header' },
							{ text: Creator.userName, style: 'subheader' },
							{ text: "Generated on " + Util.formatDate(), style: 'smallSubheader' }
						],
						{
							image: Resources.med,
							width: MIDdocument.logoSize
						}
					]
				},

				{
					table: {
						widths: [MIDdocument.labelWidth, '*'],
						body: fields
					},
					style: 'fields',
					layout: 'noBorders'
				}
			],

			styles: MIDdocument.documentStyle
		};
	return pdfMake.createPdf(doc);
	}

	/**
	 * Turns the fields the Creator engine provides us with into an object
	 * that can be actually inserted into the object used for creating the PDF.
	 * @param {Array} values - The values provided by the Creator engine.
	 * @param {string} values[].label - The label of the field.
	 * @param {string} values[].field - The text of the field.
	 */
	MIDdocument.parseFields = function (values) {
		var fields = [];
		for (i = 0; i &lt; values.length; i++) {
			if (values[i].label) {
				fields.push([{text: values[i].label, bold: true}, values[i].field]);
			} else if (values[i].field) {
				fields.push([{text: values[i].field, colSpan: 2}, {}]);
			}
		}
		return fields;
	}

	// The Creator engine needs to get 2 functions from the document-specific engine
	Creator.getMethod(function (callback) {
		MIDdocument.createPDF().getDataUrl(callback);
	});
	Creator.downloadMethod(function (name) {
		MIDdocument.createPDF().download(name);
	});
	Creator.saveEndpoint = '/save/document';
	Creator.init();

	return MIDdocument;

});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-creator.html">creator</a></li><li><a href="module-MIDcard.html">MIDcard</a></li><li><a href="module-MIDdocument.html">MIDdocument</a></li><li><a href="module-util.html">util</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Apr 05 2017 16:35:10 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
